<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="StudyMateTest.Views.ReminderPage"
             Title="Напоминания">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок и кнопка добавления -->
        <Grid Grid.Row="0" BackgroundColor="#6366F1" Padding="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackLayout Grid.Column="0" VerticalOptions="Center">
                <Label Text="Мои напоминания" 
                       FontSize="24" 
                       FontAttributes="Bold" 
                       TextColor="White"/>
                <Label x:Name="ReminderCountLabel" 
                       Text="0 активных напоминаний" 
                       FontSize="14" 
                       TextColor="White" 
                       Opacity="0.8"/>
            </StackLayout>

            <Button Grid.Column="1"
                    Text="+"
                    FontSize="24"
                    FontAttributes="Bold"
                    BackgroundColor="White"
                    TextColor="#6366F1"
                    WidthRequest="50"
                    HeightRequest="50"
                    CornerRadius="25"
                    Clicked="OnAddReminderClicked"/>
        </Grid>

        <!-- Список напоминаний -->
        <ScrollView Grid.Row="1" Padding="20">
            <StackLayout>
                <Label x:Name="EmptyStateLabel"
                       Text="Нажмите '+' чтобы создать первое напоминание"
                       FontSize="16"
                       TextColor="Gray"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"
                       Margin="0,50,0,0"
                       IsVisible="True"/>

                <CollectionView x:Name="RemindersCollectionView" 
                                BackgroundColor="Transparent">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="0,5">
                                <Frame BackgroundColor="White" 
                                       BorderColor="#E5E7EB" 
                                       CornerRadius="12" 
                                       Padding="16"
                                       HasShadow="True">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Заголовок -->
                                        <Label Grid.Row="0" Grid.Column="0" 
                                               Text="{Binding Title}" 
                                               FontSize="18" 
                                               FontAttributes="Bold" 
                                               TextColor="#1F2937"/>

                                        <!-- Статус -->
                                        <Label Grid.Row="0" Grid.Column="1" 
                                               Text="{Binding StatusText}" 
                                               FontSize="12" 
                                               TextColor="#10B981" 
                                               BackgroundColor="#ECFDF5" 
                                               Padding="8,4"
                                               VerticalOptions="Start"/>

                                        <!-- Описание -->
                                        <Label Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                               Text="{Binding Message}" 
                                               FontSize="14" 
                                               TextColor="#6B7280" 
                                               Margin="0,5,0,0"
                                               IsVisible="{Binding Message, Converter={StaticResource IsNotNullOrEmptyConverter}}"/>

                                        <!-- Время -->
                                        <Label Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
                                               Text="{Binding DisplayTime}" 
                                               FontSize="14" 
                                               TextColor="#9CA3AF" 
                                               Margin="0,5,0,0"/>

                                        <!-- Кнопки действий -->
                                        <StackLayout Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" 
                                                     Orientation="Horizontal" 
                                                     HorizontalOptions="End" 
                                                     Margin="0,10,0,0">
                                            <Button Text="✏️ Изменить"
                                                    FontSize="12"
                                                    BackgroundColor="#F3F4F6"
                                                    TextColor="#374151"
                                                    Padding="12,6"
                                                    CornerRadius="6"
                                                    Margin="0,0,10,0"
                                                    Clicked="OnEditReminderClicked"/>
                                            <Button Text="🗑️ Удалить"
                                                    FontSize="12"
                                                    BackgroundColor="#FEF2F2"
                                                    TextColor="#DC2626"
                                                    Padding="12,6"
                                                    CornerRadius="6"
                                                    Clicked="OnDeleteReminderClicked"/>
                                        </StackLayout>
                                    </Grid>
                                </Frame>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </StackLayout>
        </ScrollView>

        <!-- Нижние кнопки -->
        <Grid Grid.Row="2" Padding="20" BackgroundColor="#F9FAFB">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0"
                    Text="🔄 Обновить"
                    FontSize="14"
                    BackgroundColor="#6366F1"
                    TextColor="White"
                    Padding="12"
                    CornerRadius="8"
                    Margin="0,0,5,0"
                    Clicked="OnRefreshClicked"/>

            <Button Grid.Column="1"
                    Text="🗑️ Очистить все"
                    FontSize="14"
                    BackgroundColor="#EF4444"
                    TextColor="White"
                    Padding="12"
                    CornerRadius="8"
                    Margin="5,0,0,0"
                    Clicked="OnClearAllClicked"/>
        </Grid>
    </Grid>
</ContentPage>